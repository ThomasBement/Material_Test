# ---------------------------------------- #
# SizeDistribution [Python File]
# Written By: Thomas Bement
# Created On: 2021-08-11
# ---------------------------------------- #

import matplotlib.pyplot as plt

bins_sz = [0.3,0.374,0.465,0.579,0.721,0.897,1.117,1.391,1.732,2.156,2.685,3.343,4.162,5.182,6.451,8.031,10]
bins_label = [str(elem) for elem in bins_sz]

# Particle counts
plt_dat_cnt = {'No DMA Column': [], 
                'DMA Column, 0V': [],
                'DMA Column, 2000V': [],
                'DMA Column, 3000V': [],
                'DMA Column, 4000V': [],
                'DMA Column, 5000V': [],
                'DMA Column, 6000V': []}

plt_dat_cnt['No DMA Column'].append([574013.3333,387159.8333,254513.5,113605.6667,44721.5,45145.5,14464,8359.166667,4633,1225.666667,166.6666667,31.83333333,5.833333333,0.5,0,0,0])
plt_dat_cnt['No DMA Column'].append([14221.61649,14064.80842,13300.75656,7430.913125,3535.733177,3931.071139,1347.279333,892.4078477,546.369106,179.5156446,32.23455703,9.174239296,2.786873995,0.5477225575,0,0,0])
plt_dat_cnt['DMA Column, 0V'].append([734332.5,467869.1667,392044.8333,123588,53934,58000.16667,22264.5,18297.16667,9372.666667,1422.833333,140.3333333,20,2.666666667,0.1666666667,0.1666666667,0.1666666667,0])
plt_dat_cnt['DMA Column, 0V'].append([5329.466343,8222.931385,16242.45998,5764.995507,3125.01936,4086.030319,1759.290283,2016.716878,999.0879174,193.690905,45.81120678,8.099382693,1.505545305,0.4082482905,0.4082482905,0.4082482905,0])
plt_dat_cnt['DMA Column, 2000V'].append([225258.1667,121789.3333,86682,30671.83333,12334.33333,11797,4439.333333,3236.5,1674.666667,362.1666667,46.83333333,8.5,1.333333333,0.3333333333,0.3333333333,0.1666666667,0])
plt_dat_cnt['DMA Column, 2000V'].append([11608.24067,6997.169161,8143.058688,2102.712859,1144.304796,1058.880352,521.5157396,568.9427915,309.6796194,67.52308247,16.57005331,3.563705936,1.211060142,0.5163977795,0.5163977795,0.4082482905,0])
plt_dat_cnt['DMA Column, 3000V'].append([189380.1667,99069.5,49841.33333,19782.66667,7091,7084.5,2426.333333,1431.5,826.3333333,195.1666667,23.83333333,4.666666667,0.1666666667,0.3333333333,0,0,0])
plt_dat_cnt['DMA Column, 3000V'].append([8061.994875,3775.648011,2566.755669,1189.857583,394.6248852,623.4301084,200.6217004,128.024607,81.68639218,27.90997432,5.269408569,2.250925735,0.4082482905,0.8164965809,0,0,0])
plt_dat_cnt['DMA Column, 4000V'].append([185594.1667,97541.5,47963.16667,17264.83333,5408.333333,5517.166667,1820.5,1068,626.8333333,169,22.33333333,4.666666667,1.333333333,0,0,0,0])
plt_dat_cnt['DMA Column, 4000V'].append([3299.059952,3492.068885,2278.869142,1063.757005,388.9918594,427.5789596,147.1825397,101.4001972,53.23689197,27.21764134,4.03319559,2.250925735,1.366260102,0,0,0,00])
plt_dat_cnt['DMA Column, 5000V'].append([182378.5,94618.16667,46745.66667,16264.16667,5196.333333,4432,1398.833333,762,461.1666667,117.3333333,14.33333333,3.333333333,0.1666666667,0,0,0,0])
plt_dat_cnt['DMA Column, 5000V'].append([7697.533806,4883.357592,2968.449,956.3993761,397.756542,332.685437,169.8521906,79.58894396,79.71302696,21.70407028,4.366539438,1.751190072,0.4082482905,0,0,0,0])
plt_dat_cnt['DMA Column, 6000V'].append([158852.5,79432.83333,38047.16667,12895.83333,4259.5,3256.666667,1027.5,544.1666667,312.1666667,73.5,9.5,1.833333333,0.1666666667,0,0,0,0])
plt_dat_cnt['DMA Column, 6000V'].append([13109.8567,8017.868231,4743.078301,1783.727604,614.496786,569.7528119,204.52946,136.5480379,76.63789315,15.73213272,4.324349662,2.316606714,0.4082482905,0,0,0,0])

leg_lis_cnt = []
for key in plt_dat_cnt:
    if (key != 'No DMA Column'):
        leg_lis_cnt.append(key)
        for i in range(len(plt_dat_cnt[key][0])):
            try:
                plt_dat_cnt[key][0][i] = plt_dat_cnt[key][0][i]/plt_dat_cnt['No DMA Column'][0][i]
                plt_dat_cnt[key][1][i] = plt_dat_cnt[key][1][i]/plt_dat_cnt['No DMA Column'][0][i]
            except:
                plt_dat_cnt[key][0][i] = float('nan')
                plt_dat_cnt[key][1][i] = float('nan')
        plt.errorbar(bins_sz, plt_dat_cnt[key][0], yerr=0, marker='o', capsize=3, elinewidth=1, markeredgewidth=2)
plt.title('Normalized Particle Counts vs. Optical Particle Size')
plt.xlabel('Optical Particle Size [um]')
plt.ylabel('Particle Counts(dp)/Total Particle Counts')
plt.xscale('log', base=10) 
plt.xticks(bins_sz, bins_label, rotation=90)
#plt.yscale('log', base=10) 
plt.legend(leg_lis_cnt)
plt.savefig('.\Data\Figures\Size_Dist\Part_Count_Reg_Log.png', format='png', bbox_inches='tight')
plt.show()
plt.close()